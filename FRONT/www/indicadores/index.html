
<html lang="es-CL" dir="ltr" xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://ogp.me/ns/fb#" heightfull="heightfull">
  <head>
    <title>Indicadores Asistente. MAD Cognitiva</title>
    <meta charset="UTF-8"/>
    <link rel="profile" href="http://gmpg.org/xfn/11"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <link rel="apple-touch-icon" sizes="57x57" href="https://asistente-react.mycognitiva.io/assets/img/favicon/apple-icon-57x57.png"/>
    <link rel="apple-touch-icon" sizes="60x60" href="https://asistente-react.mycognitiva.io/assets/img/favicon/apple-icon-60x60.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="https://asistente-react.mycognitiva.io/assets/img/favicon/apple-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="76x76" href="https://asistente-react.mycognitiva.io/assets/img/favicon/apple-icon-76x76.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="https://asistente-react.mycognitiva.io/assets/img/favicon/apple-icon-114x114.png"/>
    <link rel="apple-touch-icon" sizes="120x120" href="https://asistente-react.mycognitiva.io/assets/img/favicon/apple-icon-120x120.png"/>
    <link rel="apple-touch-icon" sizes="144x144" href="https://asistente-react.mycognitiva.io/assets/img/favicon/apple-icon-144x144.png"/>
    <link rel="apple-touch-icon" sizes="152x152" href="https://asistente-react.mycognitiva.io/assets/img/favicon/apple-icon-152x152.png"/>
    <link rel="apple-touch-icon" sizes="180x180" href="https://asistente-react.mycognitiva.io/assets/img/favicon/apple-icon-180x180.png"/>
    <link rel="icon" type="image/png" sizes="192x192" href="https://asistente-react.mycognitiva.io/assets/img/favicon/android-icon-192x192.png"/>
    <link rel="icon" type="image/png" sizes="32x32" href="https://asistente-react.mycognitiva.io/assets/img/favicon/favicon-32x32.png"/>
    <link rel="icon" type="image/png" sizes="96x96" href="https://asistente-react.mycognitiva.io/assets/img/favicon/favicon-96x96.png"/>
    <link rel="icon" type="image/png" sizes="16x16" href="https://asistente-react.mycognitiva.io/assets/img/favicon/favicon-16x16.png"/>
    <link rel="manifest" href="https://asistente-react.mycognitiva.io/assets/img/favicon/manifest.json"/>
    <meta name="msapplication-TileColor" content="#000000"/>
    <meta name="msapplication-TileImage" content="https://asistente-react.mycognitiva.io/assets/img/favicon/ms-icon-144x144.png"/>
    <meta name="theme-color" content="#000000"/>
    <meta name="_csrf" content=""/>
    <meta name="insight-app-sec-validation" content="4d0a31e7-ca78-40a0-b0dd-a0b8415541e4"/>
    <meta name="apptrana" content="37adefb730ca40ca9d12cb9e55ed2ca3"/>
    <link href="https://asistente-react.mycognitiva.io/assets/css/main.css" rel="stylesheet"/>
    <link href="https://asistente-react.mycognitiva.io/assets/img/favicon/favicon-32x32.png" rel="Shortcut Icon"/>
    <script type="text/javascript" src="https://asistente-react.mycognitiva.io/assets/js/constant.js"></script><!--[if lt IE 9]><script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script><script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"/>
  </head>
  <body class="no-scroll" heightfull="heightfull">
    <div id="wrapper" heightfull="heightfull">
      <div class="f-row" heightfull="heightfull">
        <div class="f-col menu active" heightfull="heightfull" padding="padding">
          <div class="header">
            <div class="f-row align-center">
              <div class="f-col cognitiva-logo"><img src="https://asistente-react.mycognitiva.io/assets/img/cognitiva-logo.png" alt=""/></div>
            </div>
          </div>
          <ul class="menu" id="mainmenu">
            <li id="config-asis-btn"><a href="https://asistente-react.mycognitiva.io/"><i class="fa fa-cog" aria-hidden="true"></i>Configurar Asistente</a></li>
            <li id="personalizar-asis-btn"><a href="https://asistente-react.mycognitiva.io/personalizar/"><i class="fa fa-paint-brush" aria-hidden="true"></i>Personalizar Asistente</a></li>
            <li><a href="https://asistente-react.mycognitiva.io/indicadores/"><i class="fa fa-bar-chart" aria-hidden="true"></i>Indicadores</a>
              <ul class="sub-menu">
                <li><a href="https://asistente-react.mycognitiva.io/indicadores/interacciones/"><i class="fa fa-caret-right" aria-hidden="true"></i>Interacciones</a></li>
                <li><a href="https://asistente-react.mycognitiva.io/indicadores/origen/"><i class="fa fa-caret-right" aria-hidden="true"></i>Origen</a></li>
                <li><a href="https://asistente-react.mycognitiva.io/indicadores/valoraciones/"><i class="fa fa-caret-right" aria-hidden="true"></i>Valoraciones</a></li>
                <li><a href="https://asistente-react.mycognitiva.io/indicadores/nps/"><i class="fa fa-caret-right" aria-hidden="true"></i>NPS</a></li>
                <li><a href="https://asistente-react.mycognitiva.io/indicadores/me-gusta/"><i class="fa fa-caret-right" aria-hidden="true"></i>Me gusta</a></li>
              </ul>
            </li>
            <li id="admin-users-btn"><a href="https://asistente-react.mycognitiva.io/administrador-usuarios/"><i class="fa fa-users" aria-hidden="true"></i>Administrador Usuarios</a></li>
            <li id="get-code-btn"><a class="get-code" href="#;" onclick="openScript()"><i class="fa fa-code" aria-hidden="true"></i>Obtener código</a></li>
          </ul>
        </div>
        <div class="f-col content" padding="padding" heightfull="heightfull">
          <div class="row">
            <div class="col-md-12 content-header">
              <button class="btn menu" button="button" onclick="menu()"><i class="fa fa-bars"></i></button>
              <div class="mad-cognitiva">
                <h5>Mantenedor Asistente Digital / <span></span></h5>
              </div>
              <button class="user" button="button" onclick="closeSession()">
                <div id="user">Hola, <span>Ernesto</span></div><i class="fa fa-hand-peace-o"></i>
              </button>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <div class="container-tabs">
                <ul class="nav nav-tabs" id="tabs" role="tablist">
                  <li class="active" role="presentation"><a href="#assessment" aria-controls="assessment" role="tab" data-toggle="tab"><span>Indicadores</span></a></li>
                </ul>
                <div class="tab-content">
                  <div class="tab-pane fade in active" id="assessment" role="tabpanel">
                    <div class="scroll">
                      <div class="row">
                        <div class="col-md-12" margin-bottom="margin-bottom">
                          <div class="inner">
                            <h5>Interacciones <b>Diarias</b> <span></span></h5>
                            <div id="chart_div"></div><a class="view-more" href="../indicadores/interacciones/">Ver más<i class="fa fa-plus" aria-hidden="true"></i></a>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-md-6" margin-bottom="margin-bottom">
                          <div class="inner">
                            <h5>Valoraciones por <b>Origen</b> <span></span></h5>
                            <div id="chart_div2"></div><a class="view-more" href="../indicadores/origen/">Ver más<i class="fa fa-plus" aria-hidden="true"></i></a>
                          </div>
                        </div>
                        <div class="col-md-6" margin-bottom="margin-bottom">
                          <div class="inner">
                            <h5>Valoraciones <b>Totales</b> <span></span></h5>
                            <div id="chart_div3"></div><a class="view-more" href="../indicadores/valoraciones/">Ver más<i class="fa fa-plus" aria-hidden="true"></i></a>
                          </div>
                        </div>
                        <div class="col-md-6" margin-bottom="margin-bottom">
                          <div class="inner">
                            <h5><b>NPS</b> <span></span></h5>
                            <div class="row">
                              <div class="col-md-5">
                                <div id="promedio-isn">0.0</div>
                              </div>
                              <div class="col-md-7">
                                <div class="row">
                                  <div class="col-md-6">
                                    <ul class="circles-assessment">
                                      <li class="sat">Promotores</li>
                                      <li class="neu">Neutros</li>
                                      <li class="ins">Detractores</li>
                                    </ul>
                                  </div>
                                  <div class="col-md-6">
                                    <div class="assessment">
                                      <div class="col-5 yellow"> </div>
                                      <div class="col-3 gray"></div>
                                      <div class="col-1 blue"></div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div><a class="view-more" href="../indicadores/nps/">Ver más<i class="fa fa-plus" aria-hidden="true"></i></a>
                          </div>
                        </div>
                        <div class="col-md-6" margin-bottom="margin-bottom">
                          <div class="inner">
                            <h5>Me Gusta <b>Totales</b> <span></span></h5>
                            <div id="chart_div4"></div><a class="view-more" href="../indicadores/me-gusta/">Ver más<i class="fa fa-plus" aria-hidden="true"></i></a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="tab-pane fade" id="details" role="tabpanel">
                    <div class="scroll">
                      <table class="table table-striped table-bordered">
                        <thead>
                          <tr>
                            <th>Origen</th>
                            <th>Valoración</th>
                            <th>Comentario</th>
                            <th>Fecha</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                          <tr>
                            <td>App</td>
                            <td>2</td>
                            <td>Falta información más detallada</td>
                            <td>13/11/2017</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button class="close" type="button" data-dismiss="modal" aria-label="Close"><i class="fa fa-close"></i></button>
            <h6 class="modal-title"></h6>
          </div>
          <div class="modal-body"></div>
        </div>
      </div>
    </div>
    <div class="modal fade" id="myModalScript" tabindex="-1" role="dialog" aria-labelledby="myModalScriptLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button class="close" type="button" data-dismiss="modal" aria-label="Close"><i class="fa fa-close"></i></button>
            <h6 class="modal-title">Copia y pega el siguiente código en tu web. Después de <span class="code"><span>&lt;</span>head<span>&gt;</span></span> y antes de <span class="code"><span>&lt;/</span>head<span>&gt;</span></span></h6>
          </div>
          <div class="modal-body">
            <pre text-left="text-left"></pre>
          </div>
        </div>
      </div>
    </div>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="../assets/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../assets/js/crypto-js.min.js"></script>
    <script type="text/javascript" src="../assets/js/main.js"></script>
    <script>
      var d = new Date();
      var e = new Date();
          f = e.setDate(e.getDate() - 30);
          g = new Date(f);
      
      var month = new Array();
        month[0] = "Enero";
        month[1] = "Febrero";
        month[2] = "Marzo";
        month[3] = "Abril";
        month[4] = "Mayo";
        month[5] = "Junio";
        month[6] = "Julio";
        month[7] = "Agosto";
        month[8] = "Septiembre";
        month[9] = "Octubre";
        month[10] = "Noviembre";
        month[11] = "Diciembre";
      var n = month[d.getMonth()];
      
      $('.inner h5 span').text(n);
      
      function getInteractions(){
        var promise = $.ajax({
          type: 'POST',
          url: getPath+'mant/indicadores_interaccion',
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer "+getTkn,
            "Cache-Control": "no-cache",
          },
          data:  JSON.stringify(
            {
              mes: d.getMonth() + 1,
              ano: d.getFullYear(),
              id_cliente: getSession
            }
          ),
          dataType: 'json',
          contentType: 'application/json; charset=utf-8'
        }).done(function(response){
      
          if(response.estado !== undefined && response.estado.codigoEstado===200){
            var getMyArray = [['días', 'interacciones']];
            var pushArray = [];
            for(var i = 0; i < response.respuesta.length; i++) {
              pushArray = [parseInt(response.respuesta[i].dia)+' '+month[parseInt(response.respuesta[i].mes) - 1], response.respuesta[i].total];
              getMyArray.push(pushArray);
            }
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);
            
            function drawChart() {
              var data = google.visualization.arrayToDataTable(getMyArray);
              var options = {
                height: 180,
                hAxis: {
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  },
                  title: '',
                  titleTextStyle: {
                    color: '#f00'
                  },
                  minValue: 1,
                  maxValue: (getMyArray.length - 1),
                  gridlines: {
                    color: 'none'
                  }
                },
                vAxis: {
                  minValue: 0,
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  }
                },
                chartArea:{
                  left: '5%',
                  top: '5%',
                  width: '93%',
                  height: '75%'
                },
                crosshair: {
                  focused: {
                    color: '#3bc',
                    opacity: 0.8
                  }
                },
                legend: 'none',
                pointSize: 9,
                tooltip: {
                  showColorCode: true,
                  textStyle: {
                    color: '#1c75bc',
                    fontName: 'Roboto',
                  }
                },
                colors:['#001e37','#141921'],
                areaOpacity: .85,
                is3D: true,
                backgroundColor: { fill:'transparent' }
              };
              var chart = new google.visualization.AreaChart(document.getElementById('chart_div'));
              chart.draw(data, options);
            }
          }else{
            $('#chart_div').html('<p>No se han encontrado datos</p>')
            return false;
          }
      
        });
      }
      
      function getOriginData(){
        var args = {
          id_cliente: getSession,
          mes: (d.getMonth() + 1)
        }
        var promise = $.ajax({
          type: 'POST',
          url: getPath+"mant/datosOrigen",
          data: JSON.stringify(args),
          dataType: 'json',
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer "+getTkn,
            "Cache-Control": "no-cache",
          },
          contentType: 'application/json; charset=utf-8'
        }).done(function(response){
          if(response.estado !== undefined && response.estado.codigoEstado == '200'){
            google.charts.load("current", {packages:['corechart']});
            google.charts.setOnLoadCallback(drawChart);
            function drawChart() {
              if(response.data[0]!==undefined){
                var data = google.visualization.arrayToDataTable([
                  ['', 'Valoraciones', { role: "style" }],
                  ['APP', response.data[0].cantidad , 'color: #1c75bc'],
                  ['DESKTOP', response.data[1].cantidad , 'color: #043d5d'],
                  ['MOBILE', response.data[2].cantidad, 'color: #1c75bc']
                ]);
              }
              var view = new google.visualization.DataView(data);
              view.setColumns(
                [0, 1, {
                  type: "string",
                  role: "annotation"
                },
                2]
              );
              var options = {
                height: 180,
                hAxis: {
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  },
                  title: '',
                  titleTextStyle: {
                    color: '#f00'
                  },
                  minValue: 1,
                  gridlines: {
                    color: 'none'
                  }
                },
                vAxis: {
                  minValue: 0,
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  }
                },
                chartArea:{
                  left: '5%',
                  top: '5%',
                  width: '93%',
                  height: '75%'
                },
                legend: 'none',
                pointSize: 9,
                tooltip: {
                  showColorCode: true,
                  textStyle: {
                    color: '#1c75bc',
                    fontName: 'Roboto',
                  }
                },
                areaOpacity: .85,
                is3D: true,
                backgroundColor: {
                  fill: 'transparent'
                },
                legend: {
                  position: 'none'
                },
                bar: {
                  groupWidth: "20%"
                }
              };
              var chart = new google.visualization.ColumnChart(document.getElementById('chart_div2'));
              chart.draw(view, options);
            }
          }else{
            $('#chart_div2').html('<p>No se han encontrado datos</p>')
            return false;
          }
        })
      }
      
      function getAssessment(){
        var args = {
          id_cliente: getSession,
          mes: (d.getMonth() + 1),
          ano: d.getFullYear()
        }
        var promise = $.ajax({
          type: 'POST',
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer "+getTkn,
            "Cache-Control": "no-cache",
          },
          url: getPath+"mant/indicadores_valoracion",
          data: JSON.stringify(args),
          dataType: 'json',
          contentType: 'application/json; charset=utf-8'
        }).done(function(response){
          if(response.estado !== undefined && response.estado.codigoEstado == '200' && response[d.getMonth() + 1][0].cantidad!=null){
            var val1 = response[d.getMonth() + 1][0].cantidad,
                val2 = response[d.getMonth() + 1][1].cantidad,
                val3 = response[d.getMonth() + 1][2].cantidad,
                val4 = response[d.getMonth() + 1][3].cantidad,
                val5 = response[d.getMonth() + 1][4].cantidad;
            var insatisfechos   = val1 + val2;
            var neutros         = val3;
            var satisfechos     = val4 + val5;
            var totalAssessment = insatisfechos + neutros + satisfechos;
            var totalISN        = ((satisfechos - insatisfechos) / totalAssessment) * 100;
      
            var getFivePercent = (100 * satisfechos) / totalAssessment;
            $('.col-5').css('height', getFivePercent.toFixed(1)+'%');
            $('.col-5').empty().text(getFivePercent.toFixed(1)+'%');
      
            //- var getFourPercent = (100 * val4) / totalAssessment;
            //- $('.col-4').css('height', getFourPercent.toFixed(1)+'%');
      
            var getThreePercent = (100 * val3) / totalAssessment;
            $('.col-3').css('height', getThreePercent.toFixed(1)+'%');
            $('.col-3').empty().text(getThreePercent.toFixed(1)+'%');
      
            //- var getTwoPercent = (100 * val2) / totalAssessment;
            //- $('.col-2').css('height', getTwoPercent.toFixed(1)+'%');
      
            var getOnePercent = (100 * insatisfechos) / totalAssessment;
            $('.col-1').css('height', getOnePercent.toFixed(1)+'%');
            $('.col-1').empty().text(getOnePercent.toFixed(1)+'%');
            
            $('#promedio-isn').empty().append(totalISN.toFixed(1)+'<span class="percentage">%</span>');
            
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);
            function drawChart() {
              var data = google.visualization.arrayToDataTable([
                ['', ''],
                ['5 estrellas', val5],
                ['4 estrellas', val4],
                ['3 estrellas', val3],
                ['2 estrellas', val2],
                ['1 estrellas', val1]
              ]);
              var options = {
                pieStartAngle: 90,
                height: 180,
                hAxis: {
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  },
                  title: '',
                  titleTextStyle: {
                    color: '#f00'
                  },
                  minValue: 1,
                  gridlines: {
                    color: 'none'
                  }
                },
                vAxis: {
                  minValue: 0,
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  }
                },
                chartArea:{
                  left: '5%',
                  top: '5%',
                  width: '93%',
                  height: '75%'
                },
                crosshair: {
                  focused: {
                    color: '#3bc',
                    opacity: 0.8
                  }
                },
                legend: {
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  }
                },
                pointSize: 9,
                tooltip: {
                  trigger: 'none'
                },
                colors:['#e7b81d','#001e37','#b4b8ba','#009dc3','#1c75bc'],
                areaOpacity: .85,
                backgroundColor: {
                  fill:'transparent'
                },
                chartArea: {
                  height: 160
                },
                pieSliceText: 'value'
              };
              var chart = new google.visualization.PieChart(document.getElementById('chart_div3'));
              chart.draw(data, options);
            }
          }else{
            $('#chart_div3').html('<p>No se han encontrado datos</p>')
            return false;
          }
        })
      }
      
      function getLikes(){
        var promise = $.ajax({
          type: 'POST',
          url: getPath+'mant/indicadores_likes',
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer "+getTkn,
            "Cache-Control": "no-cache",
          },
          data:  JSON.stringify(
            {
              mes: d.getMonth() + 1,
              ano: d.getFullYear()
            }
          ),
          dataType: 'json',
          contentType: 'application/json; charset=utf-8'
        }).promise().done(function(response){
          if(response.estado !== undefined && response.estado.codigoEstado !== 200){
            $('#chart_div5').html('<p>No se han encontrado datos</p>')
            return false;
          }else{
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);
            function drawChart() {
              var data = google.visualization.arrayToDataTable([
                ['', ''],
                ['Positivos', response.descripcion[0].positivo],
                ['Negativos', response.descripcion[0].negativo]
              ]);
              var options = {
                height: 180,
                hAxis: {
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  },
                  title: '',
                  titleTextStyle: {
                    color: '#f00'
                  },
                  minValue: 1,
                },
                vAxis: {
                  minValue: 0,
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  }
                },
                pieHole: 0.4,
                is3D: true,
                chartArea:{
                  left: '5%',
                  top: '5%',
                  width: '93%',
                  height: '75%'
                },
                crosshair: {
                  focused: {
                    color: '#3bc',
                    opacity: 0.8
                  }
                },
                legend: {
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  }
                },
                colors:['#e7b81d','#001e37','#b4b8ba','#009dc3','#1c75bc'],
                areaOpacity: .85,
                backgroundColor: {
                  fill:'transparent'
                },
                chartArea: {
                  height: 160
                }
              };
              var chart = new google.visualization.PieChart(document.getElementById('chart_div4'));
              chart.draw(data, options);
            }
          }
        });
      }
      
      function getInteraccionesValoradas(){
        var promise = $.ajax({
          type: 'POST',
          url: getPath+'mant/filtros',
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer "+getTkn,
            "Cache-Control": "no-cache",
          },
          data:  JSON.stringify(
            {
              tipo: 'interacciones_valoradas',
              inicio: g.toISOString().substring(0,10),
              fin: d.toISOString().substring(0,10),
              id_cliente: getSession,
              canal: 'all'
            }
          ),
          dataType: 'json',
          contentType: 'application/json; charset=utf-8'
        }).promise().done(function(response){
          if(response.estado !== undefined && response.estado.codigoEstado !== 200){
            $('#chart_div5').html('<p>No se han encontrado datos</p>')
            return false;
          }else{
            var data = [
              ['Día', 'Totales', 'Valoradas']
            ];
            var responseData = response.respuesta;
      
            for(var i = 0; i < responseData.length; i++){
              var day = parseInt(responseData[i].dia)+' '+month[parseInt(responseData[i].mes) - 1];
              if($('#by-hour').hasClass('active') == true)
                day = responseData[i].hora + ':00';
              data.push([day, responseData[i].total_interacciones, responseData[i].total_interacciones_valoradas])
            }
      
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);
      
            function drawChart() {
              var arrayData = google.visualization.arrayToDataTable(data)
              var getMyArray = [['días', 'interacciones', 'interacciones valoradas']];
      
              var options = {
                  height: 180,
                  hAxis: {
                    textStyle: {
                      fontName: 'Roboto',
                      bold: true
                    },
                    title: '',
                    titleTextStyle: {
                      color: '#f00'
                    },
                    minValue: 1,
                    maxValue: (getMyArray.length - 1),
                    gridlines: {
                      color: 'none'
                    }
                  },
                  vAxis: {
                    minValue: 0,
                    textStyle: {
                      fontName: 'Roboto',
                      bold: true
                    }
                  },
                  chartArea:{
                    left: '5%',
                    top: '5%',
                    width: '93%',
                    height: '75%'
                  },
                  crosshair: {
                    focused: {
                      color: '#3bc',
                      opacity: 0.8
                    }
                  },
                  legend: 'none',
                  pointSize: 9,
                  tooltip: {
                    showColorCode: true,
                    textStyle: {
                      color: '#1c75bc',
                      fontName: 'Roboto',
                    }
                  },
                  colors:['#007fa3', '#001e37'],
                  areaOpacity: 0.9,
                  backgroundColor: { fill:'transparent' }
                };
                var chart = new google.visualization.AreaChart(document.getElementById('chart_div5'));
                chart.draw(arrayData, options);
            }
          }
        });
      }
      //getInteraccionesValoradas();
      
      function getTMO(){
        var promise = $.ajax({
          type: 'POST',
          url: getPath+'mant/tmo',
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer "+getTkn,
            "Cache-Control": "no-cache",
          },
          data:  JSON.stringify(
            {
              tipo: 'interacciones_valoradas',
              inicio: g.toISOString().substring(0,10),
              fin: d.toISOString().substring(0,10),
              id_cliente: getSession,
              canal: 'all'
            }
          ),
          dataType: 'json',
          contentType: 'application/json; charset=utf-8'
      
        }).done(function(response){
          var getMyArray = [['días', 'interacciones']];
        }).promise().done(function(response){
          if(response.estado !== undefined && response.estado.codigoEstado !== 200){
            $('#chart_div6').html('<p>No se han encontrado datos</p>')
            return false;
          }else{
            var getMyArray = [['días', 'TMO']];
            var pushArray = [];
            for(var i = 0; i < response.respuesta.length; i++) {
              pushArray = [parseInt(response.respuesta[i].dia)+' '+month[parseInt(response.respuesta[i].mes) - 1], response.respuesta[i].tmo_segundos];
              getMyArray.push(pushArray);
            }
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawChart);
            function drawChart() {
              var data = google.visualization.arrayToDataTable(getMyArray);
              var options = {
                height: 180,
                hAxis: {
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  },
                  title: '',
                  titleTextStyle: {
                    color: '#f00'
                  },
                  minValue: 1,
                  maxValue: (getMyArray.length - 1),
                  gridlines: {
                    color: 'none'
                  }
                },
                vAxis: {
                  minValue: 0,
                  textStyle: {
                    fontName: 'Roboto',
                    bold: true
                  }
                },
                chartArea:{
                  left: '5%',
                  top: '5%',
                  width: '93%',
                  height: '75%'
                },
                crosshair: {
                  focused: {
                    color: '#3bc',
                    opacity: 0.8
                  }
                },
                legend: 'none',
                pointSize: 9,
                tooltip: {
                  showColorCode: true,
                  textStyle: {
                    color: '#1c75bc',
                    fontName: 'Roboto',
                  }
                },
                colors:['#009dc3', '#001e37'],
                areaOpacity: .85,
                backgroundColor: { fill:'transparent' }
              };
              var chart = new google.visualization.AreaChart(document.getElementById('chart_div6'));
              chart.draw(data, options);
            }
          }
      
        });
        var promise = $.ajax({
          type: 'POST',
          url: getPath+"mant/indicadores_interaccion",
          headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer "+getTkn,
            "Cache-Control": "no-cache",
          },
          data:  JSON.stringify(
            {
              mes: (d.getMonth() + 1).toString(),
              ano: d.getFullYear().toString(),
              id_cliente: getSession
            }
          ),
          dataType: 'json',
          contentType: 'application/json; charset=utf-8'
        }).done(function(response){
        });
      }
      //getTMO();
      
      function initial(){
        if(hasToken){
          getInteractions();
          getOriginData();
          getAssessment();
          getLikes();
        }else{
          setTimeout(()=>{
            initial();
          },300);
        }
      }
      
      initial();
    </script>
  </body>
</html>